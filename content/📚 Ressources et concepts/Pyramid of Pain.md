Le mod√®le de la *Pyramid of Pain* a √©t√© cr√©√© par David J. Bianco en 2014 et traduit l'id√©e selon laquelle certains marqueurs techniques d'une attaque informatique sont plus durs que d'autres √† changer pour un attaquant. Comprendre un attaquant devient alors essentiel pour le bloquer au mieux et le forcer √† faire plus d'efforts pour compromettre sa cible. Pour des acteurs cybercriminels, toutes les organisations sont des victimes potentielles, toute augmentation de la difficult√© de compromission peut conduire √† un d√©couragement de l'attaquant, √† passer √† autre chose. L'activit√© cybercriminelle est aussi li√©e √† une √©conomie de march√© o√π le temps est de l'argent. A l'instar d'un cambriolage, un attaquant va pr√©f√©rer rentrer √† un endroit o√π on ne l'a jamais vu et o√π la porte est ouverte.

Ce mod√®le liste 6 types d'indicateurs techniques ou comportementaux qui sont de plus en plus difficile pour un attaquant √† modifier. Il est int√©ressant de remarquer qu'ils sont aussi g√©n√©ralement de plus en plus difficile √† analyser et √† bloquer pour les √©quipes de s√©curit√©, notamment √† cause de risques accrus de faire des faux positifs.

![[üìé Attachments/Pyramid of Pain.excalidraw.png]]

- **Condensats (ou hashes)**: Un condensat est l'abstraction du contenu d'un fichier, il est obtenu en effectuant une op√©ration math√©matique qui le transformant en un mot de longueur fixe compos√© uniquement de chiffres et de lettres. La moindre modification du fichier source r√©sulte en la modification compl√®te du condensat qui lui est associ√©. Historiquement, les bases antivirales embarquent des listes de condensats. Pour chaque nouveau fichier d√©pos√© ou t√©l√©charg√© sur l'ordinateur, son condensat sera calcul√© et recherch√© dans la base antivirale. S'il est trouv√©, il s'agit d'un virus et il sera supprim√©. D√ª √† sa nature, le condensat est inutile pour d√©tecter un fichier l√©g√®rement diff√©rent, un attaquant doit juste modifier l√©g√®rement son code pour contourner ce type de s√©curit√©.
- **Adresses IP**: Pour mener √† bien une attaque, il faut g√©n√©ralement une ou des adresses IP d√©di√©es pour mener des scans, h√©berger ou interagir avec une charge malveillante. Si l'adresse qui est associ√©e √† cette charge est bloqu√©e, il faut recompiler son virus, le d√©placer sur une nouvelle adresse.  Pour mener des actions de reconnaissance, il est trivial de changer d'adresse IP en utilisant par exemple un VPN ou un r√©seau d'anonymisation comme Tor.
- **Domaines**: Noms de domaine et adresses IP sont des indicateurs qui sont intimement li√©s. Cependant, un attaquant pour obtenir de nouveaux noms de domaines doit en enregistrer des nouveaux, les lier √† des adresses IP qu'il poss√®de ou en g√©rer l'h√©bergement. Ce qui fait qu'il peut √™tre un peu plus long de changer un nom de domaines. Cependant avec l'av√®nement de solution d'h√©bergement et de gestion d'infrastructure tr√®s souples comme AWS ou CloudFlare, il est de plus en plus facile de changer facilement de noms de domaine.
- **Artefacts d‚Äôex√©cution**: Il s'agit de traces laiss√©es par l‚Äôex√©cution d'un code malveillant sur un ordinateur ou des √©quipements r√©seaux. Par exemple, il peut s'agir de clef de registre sur Windows, d'informations qui sont enregistr√©s par les pare-feux de l'entreprise comme un User-Agent.
- **Outils**: Il s'agit ici de d√©tecter et de bloquer des outils sp√©cifiques qui sont ma√Ætris√©s ou d√©velopp√©s par l'attaquant. Celui-ci a d√ª investir du temps pour comprendre et apprendre √† utiliser un outil, voir pour en d√©velopper un. Arriver √† le d√©tecter et le bloquer efficacement, c'est le forcer √† repartir de z√©ro et √† se r√©inventer. Les antivirus actuels cherchent √† identifier pr√©cis√©ment des familles de virus dans cet objectif. L'identification se base g√©n√©ralement sur un ensemble de r√®gles qui peuvent inclure des √©l√©ments des couches inf√©rieures.   
- **Tactics, Techniques, Proc√©dures ([[üìö Ressources et concepts/TTP|TTP]])**:  √† ce niveau, c'est le comportement d'un attaquant qui sont viser et non plus ses outils. Et ne dit-on pas que les habitudes ont la vie dure?  De nombreux acteurs vont, au cours d'une attaque, devoir effectuer des actions eux-m√™me, on parle de *hands-on-keyboard operations* (op√©ration avec les mains sur le clavier). En effet, le r√©seau d'une entreprise est souvent complexe et il est difficile d'en automatiser compl√®tement la compromission, il faut trouver o√π sont situ√©es les informations d‚Äôint√©r√™t, trouver comment y acc√©der... Ces actions sont complexes et un attaquant va avoir une mani√®re de faire, une habitude de quels outils et quelles commandes il lance, dans quel ordre, de comment il contourne tel syst√®me de s√©curit√©. Il est alors possible de mettre en place des m√©canismes de d√©tections complexes sur une suite ou un ensemble d'actions, qu'il n'est pas n√©cessairement ais√© de modifier. La r√©sistance au changement, √ßa touche tout le monde.    


# Ressources

Article on Pyramid of Pain: [http://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html](http://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html)